<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>prims.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>prims.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <h1>Minimum Spanning Tree</h1>
<ul>
<li>a Minimum Spanning Tree (MST) does not depend on a source node .</li>
<li>a Shortest Path Tree (SPT) does .</li>
<li>An MST is a global property of a graph, representing the minimum possible total edge weight to connect all vertices .</li>
<li>works of negetive weights also , but not for negetive weight cycle .</li>
<li>While algorithmically you may start building an MST from a specific vertex (e.g., Prim&rsquo;s algorithm), 
the resulting set of edges and the total weight of the MST will be the same regardless of which node is chosen as the starting point .</li>
</ul>
<h3>Problem Statement</h3>
<ul>
<li>given a <code>connected</code> <code>un-directed</code> graph</li>
<li>with the edges having <code>weights</code></li>
<li>we need to adjust the graph in such a way that <ul>
<li>by keep all the nodes connected in a minimal possible way such that each node is at most reachable from somewhere</li>
<li>and the sum of weight of all the edges shall be minimum</li>
</ul>
</li>
</ul>
<blockquote>
<p>there can be many spanning trees of a graph , but only one MST</p>
</blockquote>
<h3>Visualize :</h3>
<ul>
<li><a href="https://algorithms-visual.com/prim/?nodes=20_62_A~113_20_B~95_151_C~200_119_D~159_243_E~281_189_F~372_195_G~379_22_H~466_113_I&amp;edges=0_1_6~1_3_2~0_2_4~2_3_10~3_5_0~2_4_4~4_5_7~4_6_1~5_6_6~6_7_1~6_8_33~7_8_44~1_7_3&amp;directed=0">visualize at algorithms-visual.com</a></li>
</ul>
<h3>KeyPoints :</h3>
<ul>
<li>this algorithm works on the connected graph</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <hr />
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <blockquote>
<h2>Tracing Algorithm Steps</h2>
</blockquote>
<ul>
<li>
<p>Initially we have a Priority Queue which is used for visiting each vertex</p>
<ul>
<li>A vertex is popped from this queue in each iteration</li>
<li>iteration ends when this queue is empty</li>
<li>it stores a priority value, the priority value used in this queue is simply the cost/weight of an edge that lead to a vertex</li>
<li>it also stores the parent of that vertex</li>
</ul>
</li>
<li>
<p>In each Iteration highest priority vertex is popped ( i.e least/minimum cost vertex )</p>
<ul>
<li>highest priority means -&gt; lowest priority value</li>
</ul>
</li>
<li>
<p>As when a node is popped from this queue, it&rsquo;s neighbours are evaluated and fed into this same queue</p>
</li>
<li>
<p>Iterations continue till the queue is not empty</p>
</li>
<li>
<p>For starting this algorithm , we need to select a source .</p>
</li>
</ul>
<p>Let&rsquo;s Start ! Source 0th Vertex !</p>
<ul>
<li>NOTE : each visiting queue entry is displayed in this fashion : &lsquo;[ vertex (priority)&lt;parent&gt;]&rsquo;</li>
</ul>
<pre><code class="language-txt">


- Visiting Queue : ['[ 0 (0)&lt;None&gt;]']
        Current Node : 0
        Parent of Current Node : None
        Cost : 0
                Neighbour : 1
                        - added to priority queue : [ 1 (6)&lt;0&gt;]
                Neighbour : 2
                        - added to priority queue : [ 2 (4)&lt;0&gt;]
- Visiting Queue : ['[ 2 (4)&lt;0&gt;]', '[ 1 (6)&lt;0&gt;]']

 ---------- 

- Visiting Queue : ['[ 2 (4)&lt;0&gt;]', '[ 1 (6)&lt;0&gt;]']
        Current Node : 2
        Parent of Current Node : 0
        Cost : 4
                Neighbour : 4
                        - added to priority queue : [ 4 (4)&lt;2&gt;]
                Neighbour : 0
                - skip
                Neighbour : 3
                        - added to priority queue : [ 3 (10)&lt;2&gt;]
- Visiting Queue : ['[ 4 (4)&lt;2&gt;]', '[ 1 (6)&lt;0&gt;]', '[ 3 (10)&lt;2&gt;]']

 ---------- 

- Visiting Queue : ['[ 4 (4)&lt;2&gt;]', '[ 1 (6)&lt;0&gt;]', '[ 3 (10)&lt;2&gt;]']
        Current Node : 4
        Parent of Current Node : 2
        Cost : 4
                Neighbour : 2
                - skip
                Neighbour : 7
                        - added to priority queue : [ 7 (1)&lt;4&gt;]
                Neighbour : 5
                        - added to priority queue : [ 5 (7)&lt;4&gt;]
- Visiting Queue : ['[ 7 (1)&lt;4&gt;]', '[ 1 (6)&lt;0&gt;]', '[ 5 (7)&lt;4&gt;]', '[ 3 (10)&lt;2&gt;]']

 ---------- 

- Visiting Queue : ['[ 7 (1)&lt;4&gt;]', '[ 1 (6)&lt;0&gt;]', '[ 5 (7)&lt;4&gt;]', '[ 3 (10)&lt;2&gt;]']
        Current Node : 7
        Parent of Current Node : 4
        Cost : 1
                Neighbour : 6
                        - added to priority queue : [ 6 (1)&lt;7&gt;]
                Neighbour : 8
                        - added to priority queue : [ 8 (33)&lt;7&gt;]
                Neighbour : 4
                - skip
                Neighbour : 5
                        - existing cost : 7 from vertex : 4
                        - current cost  : 6 from vertex : 7
                        - updated to current cost
- Visiting Queue : ['[ 6 (1)&lt;7&gt;]', '[ 1 (6)&lt;0&gt;]', '[ 5 (6)&lt;7&gt;]', '[ 3 (10)&lt;2&gt;]', '[ 8 (33)&lt;7&gt;]']

 ---------- 

- Visiting Queue : ['[ 6 (1)&lt;7&gt;]', '[ 1 (6)&lt;0&gt;]', '[ 5 (6)&lt;7&gt;]', '[ 3 (10)&lt;2&gt;]', '[ 8 (33)&lt;7&gt;]']
        Current Node : 6
        Parent of Current Node : 7
        Cost : 1
                Neighbour : 1
                        - existing cost : 6 from vertex : 0
                        - current cost  : 3 from vertex : 6
                        - updated to current cost
                Neighbour : 8
                        - existing cost : 33 from vertex : 7
                        - current cost  : 44 from vertex : 6
                        - left at existing cost
                Neighbour : 7
                - skip
- Visiting Queue : ['[ 1 (3)&lt;6&gt;]', '[ 5 (6)&lt;7&gt;]', '[ 3 (10)&lt;2&gt;]', '[ 8 (33)&lt;7&gt;]']

 ---------- 

- Visiting Queue : ['[ 1 (3)&lt;6&gt;]', '[ 5 (6)&lt;7&gt;]', '[ 3 (10)&lt;2&gt;]', '[ 8 (33)&lt;7&gt;]']
        Current Node : 1
        Parent of Current Node : 6
        Cost : 3
                Neighbour : 3
                        - existing cost : 10 from vertex : 2
                        - current cost  : 2 from vertex : 1
                        - updated to current cost
                Neighbour : 6
                - skip
                Neighbour : 0
                - skip
- Visiting Queue : ['[ 3 (2)&lt;1&gt;]', '[ 5 (6)&lt;7&gt;]', '[ 8 (33)&lt;7&gt;]']

 ---------- 

- Visiting Queue : ['[ 3 (2)&lt;1&gt;]', '[ 5 (6)&lt;7&gt;]', '[ 8 (33)&lt;7&gt;]']
        Current Node : 3
        Parent of Current Node : 1
        Cost : 2
                Neighbour : 2
                - skip
                Neighbour : 1
                - skip
                Neighbour : 5
                        - existing cost : 6 from vertex : 7
                        - current cost  : 0 from vertex : 3
                        - updated to current cost
- Visiting Queue : ['[ 5 (0)&lt;3&gt;]', '[ 8 (33)&lt;7&gt;]']

 ---------- 

- Visiting Queue : ['[ 5 (0)&lt;3&gt;]', '[ 8 (33)&lt;7&gt;]']
        Current Node : 5
        Parent of Current Node : 3
        Cost : 0
                Neighbour : 7
                - skip
                Neighbour : 4
                - skip
                Neighbour : 3
                - skip
- Visiting Queue : ['[ 8 (33)&lt;7&gt;]']

 ---------- 

- Visiting Queue : ['[ 8 (33)&lt;7&gt;]']
        Current Node : 8
        Parent of Current Node : 7
        Cost : 33
                Neighbour : 7
                - skip
                Neighbour : 6
                - skip
- Visiting Queue : []

 ---------- 

</code></pre>
<p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">GRAPH_REPRESENTATION</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Reresentation of graph ( with cycle ) that we&#39;ll use for demonstration</span>
<span class="s2">                                                            Graph :</span>
<span class="s2">                                                                - Un-Directed</span>
<span class="s2">                                                                - Connected</span>
<span class="s2">                                                                - Weighted</span>

<span class="s2">                                                            +---+              3               +---+</span>
<span class="s2">                                                          / | 1 | -----------------------------| 6 |            </span>
<span class="s2">                                                         /  +---+ \                            +---+</span><span class="se">\</span>
<span class="s2">                                                        /          \                             |   \  44</span>
<span class="s2">                                                    6  /            \                            |    </span><span class="se">\</span>
<span class="s2">                                                      /              \ 2                     1   |     \ +---+</span>
<span class="s2">                                                     /                \                          |      \| 8 |</span>
<span class="s2">                                                    /                  \                         |      /+---+</span>
<span class="s2">                                              +---+/                  +---+                      |     /</span>
<span class="s2">                                              | 0 |                   | 3 |\                     |    / 33</span>
<span class="s2">                                              +---+\                 /+---+ \                    |   /</span>
<span class="s2">                                                    \               /      0 \ +---+     6     +---+/</span>
<span class="s2">                                                     \             /          \| 5 |-----------| 7 |</span>
<span class="s2">                                                    4 \           /  10        +---+           +---+</span>
<span class="s2">                                                       \         /               /             /</span>
<span class="s2">                                                        \  +---+/               /             /</span>
<span class="s2">                                                         \ | 2 |               /             /</span>
<span class="s2">                                                           +---+ \            /  7          /  1</span>
<span class="s2">                                                                  \          /             /</span>
<span class="s2">                                                                   \        /             /</span>
<span class="s2">                                                                 4  \      /             /</span>
<span class="s2">                                                                     \    /             /</span>
<span class="s2">                                                                      \ +---+__________/</span>
<span class="s2">                                                                       \| 4 | </span>
<span class="s2">                                                                        +---+ </span>

<span class="s2">                                                                Edge Explaination</span>

<span class="s2">                                                                        0 &lt;--&gt; 1 : 6</span>
<span class="s2">                                                                        0 &lt;--&gt; 2 : 4</span>
<span class="s2">                                                                        1 &lt;--&gt; 3 : 2</span>
<span class="s2">                                                                        1 &lt;--&gt; 6 : 3</span>
<span class="s2">                                                                        2 &lt;--&gt; 3 : 10</span>
<span class="s2">                                                                        2 &lt;--&gt; 4 : 4</span>
<span class="s2">                                                                        3 &lt;--&gt; 5 : 0</span>
<span class="s2">                                                                        4 &lt;--&gt; 5 : 7</span>
<span class="s2">                                                                        4 &lt;--&gt; 7 : 1</span>
<span class="s2">                                                                        5 &lt;--&gt; 7 : 6</span>
<span class="s2">                                                                        6 &lt;--&gt; 7 : 1</span>
<span class="s2">                                                                        6 &lt;--&gt; 8 : 44</span>
<span class="s2">                                                                        7 &lt;--&gt; 8 : 33</span>
<span class="s2">                                                                        </span>
<span class="s2">                                                                        </span>
<span class="s2">                                                                        </span>
<span class="s2">                                                                        </span>
<span class="s2">                                                                        </span>
<span class="s2">                                                                        </span>
<span class="s2">                                                                        </span>

<span class="s2">                                                                Resultant Minimum Spanning Tree</span>


<span class="s2">                                                            +---+              3               +---+</span>
<span class="s2">                                                            | 1 | -----------------------------| 6 |            </span>
<span class="s2">                                                            +---+ \                            +---+ </span>
<span class="s2">                                                                   \                             |      </span>
<span class="s2">                                                                    \                            |     </span>
<span class="s2">                                                                     \ 2                     1   |       +---+</span>
<span class="s2">                                                                      \                          |       | 8 |</span>
<span class="s2">                                                                       \                         |      /+---+</span>
<span class="s2">                                              +---+                   +---+                      |     /</span>
<span class="s2">                                              | 0 |                   | 3 |\                     |    / 33</span>
<span class="s2">                                              +---+\                  +---+ \                    |   /</span>
<span class="s2">                                                    \                      0 \ +---+           +---+/</span>
<span class="s2">                                                     \                        \| 5 |           | 7 |</span>
<span class="s2">                                                    4 \                        +---+           +---+</span>
<span class="s2">                                                       \                                       /</span>
<span class="s2">                                                        \  +---+                              /</span>
<span class="s2">                                                         \ | 2 |                             /</span>
<span class="s2">                                                           +---+ \                          /  1</span>
<span class="s2">                                                                  \                        /</span>
<span class="s2">                                                                   \                      /</span>
<span class="s2">                                                                 4  \                    /</span>
<span class="s2">                                                                     \                  /</span>
<span class="s2">                                                                      \ +---+__________/</span>
<span class="s2">                                                                       \| 4 | </span>
<span class="s2">                                                                        +---+ </span>

<span class="s2">&quot;&quot;&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <blockquote>
<p><strong>minimum weight : 48</strong></p>
</blockquote>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <hr />
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Imports</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ds</span><span class="w"> </span><span class="kn">import</span> <span class="n">PriorityQueue</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>Custom Types</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <ul>
<li>a node ( vertex ) type</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">Node</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;Node&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <ul>
<li>a weight/cost/priority type</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">Weight</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <ul>
<li>a weight/cost of edge type</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">EdgeWeight</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;EdgeWeight&#39;</span><span class="p">,</span> <span class="n">Weight</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <ul>
<li>a cost of path type</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">PathCost</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;PathCost&#39;</span><span class="p">,</span> <span class="n">Weight</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <ul>
<li>a graph type</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">Graph</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;Graph&#39;</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="n">EdgeWeight</span><span class="p">]]])</span> <span class="c1"># Weighted Adjacency List</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <h5>Graph [<em>undirected</em>] ( in adjacency list repr )</h5>
<ul>
<li>undirected graphs contains two edge b/w nodes</li>
<li>each for incoming and outgoing respectively</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span> <span class="o">=</span> <span class="p">{</span>    
    <span class="mi">0</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)},</span>
    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),},</span>
    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),},</span>
    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),},</span>
    <span class="mi">4</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),},</span>
    <span class="mi">5</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">),},</span>
    <span class="mi">6</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">44</span><span class="p">),},</span>
    <span class="mi">7</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">33</span><span class="p">),},</span>
    <span class="mi">8</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">44</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">33</span><span class="p">),},</span>
<span class="p">}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <hr />
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <h2>Minimum Spanning Tree Implementation via Prims</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span><span class="w"> </span><span class="nf">span</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">Node</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Initialization</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">to_visit</span><span class="p">:</span> <span class="n">PriorityQueue</span> <span class="o">=</span> <span class="n">PriorityQueue</span><span class="p">()</span> <span class="c1"># it&#39;ll contain all nodes explored</span>
    <span class="n">min_spanning_tree</span><span class="p">:</span> <span class="n">Graph</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">sum_min_spanning_cost</span><span class="p">:</span> <span class="n">PathCost</span> <span class="o">=</span> <span class="mi">0</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Seed</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nd">@dataclass</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Data</span><span class="p">:</span>
        <span class="n">vertex</span><span class="p">:</span> <span class="n">Node</span>
        <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Node</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">priority_queue_task</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">PathCost</span><span class="p">,</span> <span class="n">Node</span><span class="p">]</span> <span class="o">=</span> <span class="n">PriorityQueue</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="p">(</span><span class="n">vertex</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span> <span class="c1"># path cost to reach the source is 0</span>
    <span class="n">to_visit</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">priority_queue_task</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Start</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">while</span> <span class="ow">not</span> <span class="n">to_visit</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <ul>
<li><code>1</code>.visit a node ( using priority queue )</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">priority_queue_task</span><span class="p">:</span> <span class="n">PriorityQueue</span><span class="o">.</span><span class="n">Task</span> <span class="o">=</span> <span class="n">to_visit</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">current_node</span> <span class="o">=</span> <span class="n">priority_queue_task</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">vertex</span>
        <span class="n">parent_of_current_node</span> <span class="o">=</span> <span class="n">priority_queue_task</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">parent</span>
        <span class="n">cost</span><span class="p">:</span> <span class="n">PathCost</span> <span class="o">=</span> <span class="n">priority_queue_task</span><span class="o">.</span><span class="n">priority</span> 
        <span class="n">sum_min_spanning_cost</span> <span class="o">+=</span> <span class="n">cost</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <ul>
<li><code>2</code>.Add to spanning tree</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">min_spanning_tree</span><span class="p">[</span><span class="n">current_node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">parent_of_current_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">min_spanning_tree</span><span class="p">[</span><span class="n">parent_of_current_node</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">current_node</span><span class="p">,</span> <span class="n">cost</span><span class="p">))</span>
            <span class="n">min_spanning_tree</span><span class="p">[</span><span class="n">current_node</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">parent_of_current_node</span><span class="p">,</span> <span class="n">cost</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <ul>
<li><code>3</code>.Fetch it&rsquo;s neighbours</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">neighbour_info</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="n">EdgeWeight</span><span class="p">]]</span> <span class="o">=</span> <span class="n">graph</span><span class="p">[</span><span class="n">current_node</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <ul>
<li><code>4</code>.Find minimum for neighbours</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">for</span> <span class="n">neighbour_node_data</span> <span class="ow">in</span> <span class="n">neighbour_info</span><span class="p">:</span>
            <span class="n">neighbour_node</span><span class="p">,</span> <span class="n">edge_weight</span> <span class="o">=</span> <span class="n">neighbour_node_data</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <ul>
<li>don&rsquo;t count your parent as neighbour</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="n">neighbour_node</span> <span class="o">==</span> <span class="n">current_node</span><span class="p">:</span>
                <span class="k">continue</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <ul>
<li>If already added to spanning tree then skip</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="n">neighbour_node</span> <span class="ow">in</span> <span class="n">min_spanning_tree</span><span class="p">:</span>
                <span class="k">continue</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <ul>
<li><code>5</code>.Check if exists in priority queue </li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">task</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PriorityQueue</span><span class="o">.</span><span class="n">Task</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_visit</span><span class="o">.</span><span class="n">fetch_task</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="k">lambda</span> <span class="n">task</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">vertex</span> <span class="o">==</span> <span class="n">neighbour_node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">task</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <ul>
<li>if exists in priority queue &amp; current edge is smaller , then update the queue</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">if</span> <span class="n">edge_weight</span> <span class="o">&lt;</span> <span class="n">task</span><span class="o">.</span><span class="n">priority</span><span class="p">:</span>
                    <span class="n">to_visit</span><span class="o">.</span><span class="n">task_priority_update</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">edge_weight</span><span class="p">)</span> <span class="c1"># signifies that , a shorter edge exists to reach this neighbour with cost == `edge_weight`  </span>
                    <span class="n">task</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">current_node</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <ul>
<li>if not exists in priority queue , then add</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">else</span><span class="p">:</span>
                <span class="n">to_visit</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">PriorityQueue</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="n">edge_weight</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="p">(</span><span class="n">vertex</span><span class="o">=</span><span class="n">neighbour_node</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">current_node</span><span class="p">)))</span> <span class="c1"># signifies that , we have found an `edge_weight` cost to reach this neighbour </span>
        
    <span class="k">return</span> <span class="n">min_spanning_tree</span><span class="p">,</span> <span class="n">sum_min_spanning_cost</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="n">min_spanning_tree</span><span class="p">,</span> <span class="n">sum_min_spanning_cost</span> <span class="o">=</span> <span class="n">span</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">min_spanning_tree</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sum_min_spanning_cost</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
